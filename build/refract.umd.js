(function(h,_){typeof exports=="object"&&typeof module<"u"?_(exports):typeof define=="function"&&define.amd?define(["exports"],_):(h=typeof globalThis<"u"?globalThis:h||self,_(h.Refract={}))})(this,function(h){"use strict";function _(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&Object.prototype.toString.call(e)==="[object Object]"}function S(e){return["boolean","string","number","undefined"].includes(typeof e)||e===null||e instanceof Error}const se="http://www.w3.org/2000/svg",Ce=new Set(["svg","a","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","switch","symbol","text","textPath","title","tspan","use","view"]),ke=new Set(["math","maction","maligngroup","malignmark","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mlongdiv","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mscarries","mscarry","msgroup","msline","mspace","msqrt","msrow","mstack","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Ae="http://www.w3.org/1998/Math/MathML",q=/(PointerCapture)$|Capture$/i,Me=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Te(e){const t=[];for(const n in e){const r=e[n],o=n.replace(/([A-Z])/g,"-$1").toLowerCase();typeof r!="number"||Me.test(o)?t.push(`${o}: ${r};`):t.push(`${o}: ${r}px;`)}return t.join(" ")}function Pe(e){const t={};for(const n in e){const r=e[n];if(typeof r=="object"&&r!==null){console.warn(`Nested styles not allowed for ${n}`);continue}r==null||r===!1||r===""||(t[n]=r)}return t}function Le(e){return _(e)||typeof e=="string"}function Ne(e,t){if(!Le(e))throw new Error("Style attribute must be a plain object or a string");if(typeof e=="string")t.setAttribute("style",e);else{const n=Pe(e);t.setAttribute("style",Te(n))}}function Re(e,t,n,r){e.__propName=t;const o=Ze(e);o==null||o===!1||(K(t,o,n,r),e.__signals&&Je(e,n))}const De=/(PointerCapture)$|Capture$/i;function K(e,t,n,r){if(e=="style"){Ne(t,n);return}if(e[0]==="o"&&e[1]==="n"&&typeof t=="function"){const o=e!=(e=e.replace(De,"$1"));e.toLowerCase()in n||e=="onFocusOut"||e=="onFocusIn"||e==="onGotPointerCapture"||e==="onLostPointerCapture"?e=e.toLowerCase().slice(2):e=e.slice(2),n.addEventListener(e,t,o);return}if(r===se)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e!=="rowSpan"&&e!=="colSpan"&&e!=="role"&&e!=="popover"&&e in n)try{e==="value"&&n.tagName==="SELECT"?setTimeout(()=>{n[e]=t??""}):n[e]=t??"";return}catch{}t!=null&&(t!==!1||e[4]==="-")&&n.setAttribute(e,e==="popover"&&t===!0?"":t)}const w=Symbol("FRAGMENT");function J(e,t,...n){if(e==="FRAGMENT"){const r=L(n);return r[w]=!0,r}return{type:e,props:{...t,children:L(n)}}}function L(e){return e.map(t=>{if(typeof t=="object"){if(Array.isArray(t))return L(t);if(t===null)return Q("");if(!t.type||!t.props)throw new Error("Invalid type for a dom node, found "+t);return t}else if(typeof t=="function"){const n=Ve(t);if(S(n))return Y("TEXT_CHILD",{nodeValue:n!=null&&n!==!1?String(n):"",children:[]},t);if(Array.isArray(n)){const r=n[w];return Y("FRAGMENT",{children:r?n:L(n)},t)}else if(!n.type||!n.props)throw new Error("Invalid type for a dom node, found "+n);return Y(n.type,n.props,t)}else return Q(t)}).flat()}function Q(e){return{type:"TEXT_CHILD",props:{nodeValue:e!=null&&e!==!1?String(e):"",children:[]}}}function Y(e,t,n){return{type:e,renderFunction:n,props:t}}function Ie(e){return e!=="children"&&e!=="key"&&e!=="ref"}function le(e){let t=null;Ce.has(e.type)?t=se:ke.has(e.type)&&(t=Ae);const n=e.type==="TEXT_CHILD"?document.createTextNode(""):t?document.createElementNS(t,e.type,e.props.is&&e.props):document.createElement(e.type);if(!e.props)return n;e.props.ref&&e.props.ref instanceof oe&&n instanceof HTMLElement&&(e.props.ref.current=n);for(const r in e.props){if(!Ie(r))continue;const o=e.props[r];typeof o=="function"&&r[0]!=="o"&&r[1]!=="n"?Re(o,r,n,t):K(r,o,n,t)}return n}function Ge(e,t,n){n==null||e==="key"||K(e,n,t)}function Oe(e,t){V=t;const n=document.createDocumentFragment();Z=n;const r={type:"div",props:{children:[e]},dom:n};e.parent=r,C.push(e),requestIdleCallback(ce)}function $e(){Z&&V&&V.appendChild(Z)}let C=[],V=null,Z=null,I=[];function ae(){for(let e=0;e<I.length;e++){const t=I[e];_e(t)}I.length=0}function ce(e){ae();let t=!1;for(;C.length>0&&!t;){const n=C.pop();He(n),t=e.timeRemaining()<1}if(C.length==0){$e(),ae();return}requestIdleCallback(ce)}function He(e){var t;if(e.type==="FRAGMENT"){const n=!e.props.children[w];let r=!1;for(let o=e.props.children.length-1;o>=0;o--)e.props.children[o].parent=e,n&&e.props.children[o].props.key===void 0&&e.renderFunction&&(r=!0),C.push(e.props.children[o]);r&&console.error("Array children must have a key attribute")}else if(typeof e.type=="function"){me(e);const n=e.type(e.props);if(we(),Array.isArray(n)){for(let r=n.length-1;r>=0;r--)n[r].parent=e,C.push(n[r]);e.props.children=n}else n.parent=e,e.props.children.push(n),C.push(n);I.push(e)}else{e.dom||(e.dom=le(e));let n=e.parent;for(;n&&!n.dom;)n=n.parent;n&&((t=n.dom)==null||t.appendChild(e.dom));for(let r=e.props.children.length-1;r>=0;r--)e.props.children[r].parent=e,C.push(e.props.children[r])}O(e)}function A(e){if(e.type==="FRAGMENT")if(e.props.children[w])for(const n of e.props.children)n.parent=e,A(n);else{let n=!1;for(const r of e.props.children)r.parent=e,r.props.key===void 0&&(n=!0),A(r);n&&console.error("Array children must have a key attribute")}else if(typeof e.type!="function")for(const t of e.props.children)t.parent=e,A(t);O(e)}function y(e,t,n,r,o){var l,i;if(e.type==="FRAGMENT")for(const s of e.props.children)r&&(s.parent=e),y(s,t,n,r,o);else if(typeof e.type=="function"){me(e);const s=e.type(e.props);if(we(),Array.isArray(s)){for(const a of s)a.parent=e,y(a,t,n,!0,o);e.props.children=s}else s.parent=e,e.props.children.push(s),y(s,t,n,!0,o);queueMicrotask(()=>{_e(e)})}else{if(e.dom||(e.dom=le(e)),t)n?(l=t.parentElement)==null||l.replaceChild(e.dom,t):(i=t.parentElement)==null||i.insertBefore(e.dom,t);else{let s;if(o)s=o;else{let a=e.parent;for(;a&&!a.dom;)a=a.parent;s=a==null?void 0:a.dom}s==null||s.appendChild(e.dom)}for(const s of e.props.children)r&&(s.parent=e),y(s,void 0,void 0,r,e.dom)}r&&O(e)}let G=!0;function m(e,t){if(!(!e||!G)){if(e.renderFunction&&(t&&Ye(e.renderFunction),delete e.renderFunction),e.dom){for(const n in e.props)if(W(n)){let r=n.toLowerCase().substring(2);const o=r!=(r=r.replace(q,"$1"));e.dom.removeEventListener(r,e.props[n],o),delete e.props[n]}else typeof e.props[n]=="function"?Qe(e.props[n]):n==="ref"&&e.props[n]instanceof oe&&(e.props[n].current=null);e.dom.remove()}typeof e.type=="function"&&(ot(e,e.props),delete e.type),e.props.children.forEach(n=>m(n,!0))}}function O(e){e.renderFunction&&Ke(e.renderFunction,e)}function ue(e,t){if(S(t)){const n={...Q(t),parent:e.parent};A(n),F(e,n)}else if(Array.isArray(t)){const r={type:"FRAGMENT",props:{children:t[w]?t:L(t)},parent:e.parent};A(r),F(e,r)}else{const n={...t,parent:e.parent};A(n),F(e,n)}}function $(e,t){e.renderFunction&&(t.renderFunction=e.renderFunction,O(t))}function H(e,t,n){var r;if(n!==void 0){e.parent.props.children[n]=t;return}(r=e.parent)==null||r.props.children.forEach((o,l)=>{o===e&&(e.parent.props.children[l]=t)})}const W=e=>e.startsWith("on")||e=="onFocusOut"||e=="onFocusIn",fe=e=>e!=="children"&&!W(e)&&e!=="key"&&e!=="ref",B=(e,t,n)=>e[n]!==t[n],We=(e,t,n)=>!(n in t);function pe(e,t){var n,r;return e===t?!0:e.type!==t.type||((n=e.props)==null?void 0:n.key)!==((r=t.props)==null?void 0:r.key)?!1:N(e.props,t.props)}function N(e,t){if(e===t){if(e instanceof R&&t instanceof R)return N(e.value,t.value);if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let o=0;o<e.length;o++)if(!N(e[o],t[o]))return!1}return!0}if(S(e)&&S(t))return e===t;if(typeof e!=typeof t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let o of n)if(o!=="children"&&(!t.hasOwnProperty(o)||!N(e[o],t[o])))return!1;return!0}function de(e){if(e){if(e.dom)return e.dom;for(const t of e.props.children){const n=de(t);if(n)return n}}}function v(e){if(e){if(e.dom)return e.dom;for(let t=e.props.children.length-1;t>=0;t--){const n=e.props.children[t],r=v(n);if(r)return r}}}function Ue(e){if(e)for(let t=e.props.children.length-1;t>=0;t--){const n=e.props.children[t],r=v(n);if(r)return r}}function Xe(e){if(!e)return;let t=e.parent;for(;t&&!t.dom;)t=t.parent;return t}function ze(e){if(!e)return;if(e.dom)return e;let t=e.parent;for(;t&&!t.dom;)t=t.parent;return t}function F(e,t,n){if(!(!e&&!t)){if(e&&!t)m(e,!0),e.parent.props.children=e.parent.props.children.filter(r=>r!==e);else if(e&&t){const r=e.props,o=t.props;if(e.type==="FRAGMENT"||typeof e.type=="function")if(t.type==="FRAGMENT"||typeof t.type=="function")typeof e.type==typeof t.type&&typeof e.type=="function"?pe(e,t)||(y(t,de(e),void 0,!0),$(e,t),m(e),H(e,t,n)):he(e,t);else{t.parent=e.parent;let l=e.props.children[0];for(;l&&!l.dom;)l=l.props.children[0];y(t,l==null?void 0:l.dom),$(e,t),m(e),H(e,t,n)}else{const l=e.dom;if(e.type==="TEXT_CHILD"&&t.type==="TEXT_CHILD"&&!t.dom&&(t.dom=e.dom),l===void 0)return;if(t.type==="FRAGMENT"||typeof t.type=="function")t.parent=e.parent,$(e,t),y(t,l),m(e),H(e,t,n);else{for(const i in r)if(fe(i)&&We(r,o,i))l[i]="";else if(W(i)&&(!(i in o)||B(r,o,i))){let s=i.toLowerCase().substring(2);const a=s!=(s=s.replace(q,"$1"));l.removeEventListener(s,r[i],a)}if(e.type!==t.type)t.parent=e.parent,$(e,t),y(t,l,!0),m(e),H(e,t,n);else{for(const i in o)if(fe(i)&&B(r,o,i))l[i]=o[i],r[i]=o[i];else if(W(i)&&B(r,o,i)){let s=i.toLowerCase().substring(2);const a=s!=(s=s.replace(q,"$1"));l.addEventListener(s,o[i],a),r[i]=o[i]}he(e,t)}}}}}}function je(e,t){var a;const n=e.props.children,r=t.props.children,o={};for(let c=0;c<n.length;c++){const u=n[c].props.key;if(u==null||o.hasOwnProperty(String(u)))return!1;o[String(u)]=n[c]}const l=(a=Ue(e))==null?void 0:a.nextSibling,i=Xe(e);if(r.length===0){e.props.children.length=0,(i==null?void 0:i.dom)instanceof HTMLElement&&(i.dom.innerHTML="");return}const s=e.props.children.length;for(let c=0;c<r.length;c++){const u=r[c],j=u.props.key,E=String(j);if(o.hasOwnProperty(E)){const T=o[E];s>c?e.props.children[c]=T:e.props.children.push(T),delete o[E];const P=t.props.children[c];P&&(P.parent=e),F(T,P,c),M(e.props.children[c],i==null?void 0:i.dom,l)}else s>c?e.props.children[c]=u:e.props.children.push(u),u.parent=e,y(u,l,!1,!1,i==null?void 0:i.dom)}for(const c in o)if(o.hasOwnProperty(c)){const u=o[c];m(u,!0)}for(;e.props.children.length>t.props.children.length;)e.props.children.pop()}function M(e,t,n){if(e.dom){if(e.dom===t||e.dom===n)return;n?t.insertBefore(e.dom,n):t.appendChild(e.dom)}else for(const r of e.props.children)M(r,t,n)}function he(e,t){const n=t.type==="FRAGMENT"&&!t.props.children[w],r=e.type==="FRAGMENT"&&!e.props.children[w];n&&r?je(e,t)===!1&&ye(e,t):ye(e,t),t.type==="FRAGMENT"&&t.props.children[w]?e.props.children[w]=!0:e.props.children[w]=!1,e.type=t.type}function b(e,t){var r;let n=Math.max(e.props.children.length,t.props.children.length);for(let o=0;o<n;o++){let l=e.props.children[o],i=t.props.children[o];if(i&&(i.parent=e),!l&&i)y(i,(r=v(e.props.children.at(-1)))==null?void 0:r.nextSibling),e.props.children.push(i);else if(!i&&l)m(l,!0),e.props.children.splice(o,1),n=e.props.children.length,o--;else{F(l,i,o);const s=Math.max(e.props.children.length,t.props.children.length);s<n&&(n=s,o--)}}}function ye(e,t){let n=Math.max(e.props.children.length,t.props.children.length);const r={};let o=0;for(let s=0;s<e.props.children.length;s++){const a=e.props.children[s].props.key;if(a!=null){if(o++,r.hasOwnProperty(String(a))){console.warn("Found two children with the same key",a),console.warn("When two fibers are found having same key the whole children will default to manual updates, which can be slower than with key based reconciliation"),b(e,t);return}r[String(a)]={fiber:e.props.children[s],index:s}}}if(o==0){b(e,t);return}const l={};for(let s=0;s<t.props.children.length;s++){const a=t.props.children[s].props.key;if(a==null)continue;const c=r[String(a)];if(c){if(l.hasOwnProperty(String(a))){console.warn("Found two children with the same key",a),console.warn("When two fibers are found having same key the whole children will default to manual updates, which can be slower than with key based reconciliation"),b(e,t);return}l[String(a)]={fiber:c.fiber,newIndex:s,oldIndex:c.index}}}const i=ze(e);for(let s=0;s<n;s++){let a=e.props.children[s],c=t.props.children[s];const u=c!=null&&c.props.key?String(c.props.key):"",j=l.hasOwnProperty(u);let E=a!=null&&a.props.key?String(a.props.key):"";if(E&&u&&E===u){F(a,c,s),i!=null&&i.dom&&M(e.props.children[s],i.dom);continue}const T=l.hasOwnProperty(E)&&l[E].newIndex>s,P=l.hasOwnProperty(E)&&l[E].newIndex<s;if((T||P)&&(G=!1),c&&(c.parent=e),!a&&c)if(j){const{fiber:k}=l[u];e.props.children.push(k),F(k,c,s),i!=null&&i.dom&&M(e.props.children[s],i.dom)}else i!=null&&i.dom&&y(c,void 0,!1,!1,i.dom),e.props.children.push(c);else if(!c&&a)m(a,!0),e.props.children.splice(s,1),n=e.props.children.length,s--;else if(j){const{fiber:k}=l[u];m(a,!0),G=!0,e.props.children[s]=k,F(k,c,s),i!=null&&i.dom&&M(e.props.children[s],i.dom)}else if(T||P)i!=null&&i.dom&&y(c,void 0,!1,!1,i.dom),e.props.children[s]=c;else{F(a,c,s),i!=null&&i.dom&&M(e.props.children[s],i.dom);const k=Math.max(e.props.children.length,t.props.children.length);k<n&&(n=k,s--)}G=!0}}typeof process<"u"&&process.env.NODE_ENV==="test"&&(module.exports={createFiber:A,commitDeletion:m,commitFiber:y,updateFiber:ue,deepCompareFibers:pe,deepEqual:N});let x=!1;const ee=new Set,te=new Set,U=new WeakMap,X=new WeakMap;function qe(e){ee.add(e),x||(x=!0,queueMicrotask(()=>{ee.forEach(t=>{const n=t();if(te.has(n))return;te.add(n),n.__cleanup&&typeof n.__cleanup=="function"&&(n.__cleanup(),n.__cleanup=null);const r=n();if(typeof r=="function"&&(n.__cleanup=r),U.has(n)){const o=U.get(n);o&&ue(o,r)}if(X.has(n)){const o=X.get(n);o&&n.__propName&&Ge(n.__propName,o,r)}}),te.clear(),ee.clear(),x=!1}))}function Ke(e,t){U.set(e,t)}function Je(e,t){X.set(e,t)}function Qe(e){X.delete(e);const t=e.__signals;if(t){for(const n of t)n.removeDep(e);e.__signals=null}}function Ye(e){U.delete(e);const t=e.__signals;if(t){for(const n of t)n.removeDep(e);e.__signals=null}}let g=null,f=null;function ne(e){g.__signals||(g.__signals=new Set),g.__signals.add(e)}function re(e){f.__signals||(f.__signals=new Set),f.__signals.add(e)}function Ve(e){var n;if(typeof e!="function")throw new Error("reactive takes a render function as the argument");g=e;const t=e();if(g=null,!S(t)&&_(t)&&!t.type&&!t.props&&!((n=t.props)!=null&&n.children))throw new Error("Reactive value must be primitive or functional component, got: "+typeof t);return t}function Ze(e){if(typeof e!="function")throw new Error("reactive takes a render function as the argument");g=e;const t=e();return g=null,t}function Be(e){if(typeof e!="function")throw new Error("createEffect takes a effect function as the argument");Fe(e),Ee()||ge(e)}function ge(e,t){if(typeof e!="function")return;f=e;const n=e();f.__signals&&typeof n=="function"&&(f.__cleanup=n),!f.__signals&&n&&typeof n=="function"&&(t?rt(n,t):Se(n)),f=null}function ve(e){if(typeof e!="function")throw new Error("computed takes a function as the argument");let t=Ee()!==null;f=()=>{if(t){t=!1;return}r.update(e())},Fe(f);const n=e(),r=D(n);return f=null,{get value(){return r.value}}}function be(e){if(typeof e!="function")throw new Error("createPromise takes a function as the argument");const t=e();if(!(t instanceof Promise))throw new Error("createPromise takes a function that returns a promise");const n=D({status:"pending",data:null,error:null});return t.then(r=>{n.update(o=>{o.data=r,o.status="resolved"})}).catch(r=>{n.update(o=>{o.error=r,o.status="rejected"})}),{get value(){return n.value}}}class oe{constructor(t){this.current=t}}function xe(){return new oe(null)}const z=["push","pop","unshift","shift","splice","fill","copyWithin","sort","reverse"];class R{constructor(t){this.isNotified=!1,this._val=t,this.deps=new Set}notify(){this.isNotified||(this.deps.size!==0&&(this.isNotified=!0),this.deps.forEach(t=>{qe(()=>(this.isNotified=!1,t))}))}removeDep(t){this.deps.delete(t)}clearDeps(){this.deps.clear()}}class et extends R{constructor(t){if(!S(t))throw new Error("Invalid type for PrimitiveSignal. Valid types: [boolean, string, number, undefined, null]");super(t)}get value(){return f&&(this.deps.add(f),re(this)),g&&(this.deps.add(g),ne(this)),this._val}update(t){if(typeof t=="function"){const n=t(this._val);if(!S(n))throw new Error("Invalid type for PrimitiveSignal. Valid types: [boolean, string, number, undefined, null]");if(n===this._val)return;this._val=n,this.notify()}else{if(!S(t))throw new Error("Invalid type for PrimitiveSignal. Valid types: [boolean, string, number, undefined, null]");if(t===this._val)return;this._val=t,this.notify()}}}class tt extends R{constructor(t){if(!Array.isArray(t))throw new Error("Invalid type for ArraySignal; value must be an array");super(t),this.updateCalled=!1,this._val=this.createProxy(t)}createProxy(t){return new Proxy(t,{get:(n,r)=>{const o=n[r];if(typeof o=="function"){if(z.includes(String(r))&&!this.updateCalled)throw new Error("Cannot set a value on an array signal, use the update method for updating the array.");return(...l)=>{const i=o.apply(n,l);return z.includes(String(r))&&this.notify(),i}}return o},set:(n,r,o)=>{if(!this.updateCalled)throw new Error("Cannot set a value on an array signal, use the update method for updating the array.");return n[r]=o,this.notify(),!0}})}get value(){return f&&(this.deps.add(f),re(this)),g&&(this.deps.add(g),ne(this)),this._val}update(t){if(this.updateCalled=!0,typeof t=="function")t(this._val);else{if(!Array.isArray(t))throw new Error("Invalid type for ArraySignal; value must be an array");if(t===this._val)return;this._val=this.createProxy(t),this.notify()}this.updateCalled=!1}}class nt extends R{constructor(t){if(!_(t))throw new Error("Invalid type for ObjectSignal; value must be a plain object");super(t),this.updateCalled=!1,this._val=this.createProxy(t)}createInternalArrayProxy(t){return new Proxy(t,{get:(n,r)=>{const o=n[r];if(typeof o=="function"){if(!this.updateCalled&&z.includes(String(r)))throw new Error("Cannot set a value on an object signal, use the update method for updating the object.");return(...l)=>{const i=o.apply(n,l);return z.includes(String(r))&&this.notify(),i}}return o},set:(n,r,o)=>{if(!this.updateCalled)throw new Error("Cannot set a value on an object signal, use the update method for updating the object.");return n[r]=o,this.notify(),!0}})}createProxy(t){return new Proxy(t,{get:(n,r)=>{const o=n[r];return Array.isArray(o)?(n[r]=this.createInternalArrayProxy(o),n[r]):o},set:(n,r,o)=>{if(!this.updateCalled)throw new Error("Cannot set a value on an object signal, use the update method for updating the object.");return typeof o=="function"?!1:(typeof o=="object"&&o!==null&&(o=this.createProxy(o)),o===n[r]||(n[r]=o,this.notify()),!0)},deleteProperty:(n,r)=>{const o=delete n[r];return this.notify(),o}})}get value(){return f&&(this.deps.add(f),re(this)),g&&(this.deps.add(g),ne(this)),this._val}update(t){if(this.updateCalled=!0,typeof t=="function")t(this._val);else{if(!_(t))throw new Error("Invalid type for ObjectSignal; value must be a plain object");if(t===this._val)return;this._val=this.createProxy(t),this.notify()}this.updateCalled=!1}}function D(e){if(typeof e=="function")throw new Error("Functions cannot be used as signal value");if(typeof e=="object"&&e!==null)if(Array.isArray(e)){const t=new tt(e);return ie(t),{get value(){return t.value},update:t.update.bind(t)}}else if(_(e)){const t=new nt(e);return ie(t),{get value(){return t.value},update:t.update.bind(t)}}else throw new Error("Invalid type for signal initialization: "+typeof e);else if(S(e)){const t=new et(e);return ie(t),{get value(){return t.value},update:t.update.bind(t)}}else throw new Error("Invalid type for signal initialization: "+typeof e)}let d=null,p=new WeakMap;function me(e){d=e}function we(){d=null}function Ee(){return d}function _e(e){if(p.has(e)){const t=p.get(e);for(const n of t.effects)ge(n,e)}}function Se(e){d&&(p.has(d)?p.get(d).cleanup.push(e):p.set(d,{signals:new Set,cleanup:[e],effects:new Set}))}function rt(e,t){t&&(p.has(t)?p.get(t).cleanup.push(e):p.set(t,{signals:new Set,cleanup:[e],effects:new Set}))}function Fe(e){if(d)if(p.has(d))p.get(d).effects.add(e);else{const t=new Set;t.add(e),p.set(d,{signals:new Set,cleanup:[],effects:t})}}function ie(e){if(d)if(p.has(d))p.get(d).signals.add(e);else{const t=new Set;t.add(e),p.set(d,{signals:t,cleanup:[],effects:new Set})}}function ot(e,t){const n=p.get(e);if(n){if(n.cleanup)for(const r of n.cleanup)r();n.cleanup=[];for(const r of n.effects){if(r.__cleanup&&typeof r.__cleanup=="function"&&r.__cleanup(),r.__signals)for(const o of r.__signals)o.removeDep(r);delete r.__signals,delete r.__cleanup}n.signals.forEach(r=>r.clearDeps()),n.signals.clear()}p.delete(e)}function it(e){let t=null;const n=(r,o)=>{t?(r.update(!1),o.update(null)):e().then(l=>{if(l.default){if(typeof l.default!="function")throw new Error("Lazy-loaded component must be a functional component");t=l.default,r.update(!1),o.update(null)}else o.update(new Error("No default export found from lazy-loaded module"))}).catch(l=>{o.update(l),r.update(!1)})};return r=>{const o=D(!0),l=D(null);n(o,l);const i=s=>typeof s=="string"||s&&typeof s=="object"&&"props"in s&&"type"in s;if(r.fallback!==void 0&&!i(r.fallback))throw new Error("Invalid fallback: Expected a string or a valid JSX node.");if(r.errorFallback!==void 0&&!(typeof r.errorFallback=="function"||i(r.errorFallback)))throw new Error("Invalid errorFallback: Expected a string, a valid JSX node, or a function returning a JSX node.");return J("FRAGMENT",null,()=>o.value?r.fallback:l.value!==null?r.errorFallback?typeof r.errorFallback=="function"?r.errorFallback(l.value):r.errorFallback:"Unknown error occurred while lazy loading component, use errorFallback prop to override":t&&J(t,{...r}))}}h.cleanUp=Se,h.computed=ve,h.createEffect=Be,h.createElement=J,h.createPromise=be,h.createRef=xe,h.createSignal=D,h.lazy=it,h.render=Oe,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
